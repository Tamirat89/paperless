<odoo>

    <!-- Tree View for Purchase Request -->
    <record id="view_purchase_request_tree" model="ir.ui.view">
        <field name="name">purchase.request.tree</field>
        <field name="model">purchase.request</field>
        <field name="arch" type="xml">
            <list default_order="name desc">
                <field name="name" string="Request Reference"/>
                <field name="material_request_id" string="Material Request"/>
                <field name="date_requested" string="Requested Date"/>
                <field name="requested_by" string="Requested By"/>
                <field name="checked_by_id" string="Checked By"/>
                <field name ="approved_by_id" string="Approved By"/>
                <field name="remark" string="Remark"/>
                <field name="quality_evaluation"/>
                <field name="state" string="Status"/>
                <field name="company_id" string="Company"/>
            </list>
        </field>
    </record>

    <!-- Form View for Purchase Request -->
    <record id="view_purchase_request_form" model="ir.ui.view">
        <field name="name">purchase.request.form</field>
        <field name="model">purchase.request</field>
        <field name="arch" type="xml">
            <form string="Purchase Request">
                <header>
                    <field name="state" widget="statusbar"
                           statusbar_visible="draft,checked,reviewed,approved,rfq,supplier_analysis,quality_evaluation,purchase_order,rejected"/>
                         
                    
                    <button name="action_check" 
                            string="Check" 
                            type="object" 
                            class="btn-warning"
                            groups="custom_purchase_process.group_custom_purchase_request_purchaser"
                            invisible="state != 'draft'"/>

                    <button name="action_reject" 
                            string="Reject" 
                            type="object" 
                            class="btn-danger"
                            groups="custom_purchase_process.group_custom_purchase_request_purchaser"
                            invisible="state != 'draft'"/>

                    <button name="action_back_to_sr" 
                            string="Back to SR" 
                            type="object" 
                            class="btn-warning"
                            groups="custom_purchase_process.group_custom_purchase_request_purchaser,custom_purchase_process.group_custom_purchase_request_approvers,custom_purchase_process.group_custom_purchase_request_super_admin"
                            invisible="state != 'draft'"/>

                    <button name="action_review" 
                            string="Review" 
                            type="object" 
                            class="btn-info"
                            groups="custom_purchase_process.group_custom_purchase_request_approvers"
                            invisible="state != 'checked'"/>


                    <button name="action_reset_to_draft" 
                            string="Reset to Draft" 
                            type="object" 
                            class="btn-warning"
                            groups="custom_purchase_process.group_custom_purchase_request_approvers"
                            invisible="state != 'checked'"/>

                    <button name="action_reject" 
                            string="Reject" 
                            type="object" 
                            class="btn-danger"
                            groups="custom_purchase_process.group_custom_purchase_request_approvers"
                            invisible="state != 'checked'"/>
                    
                    
                    <button name="action_approve" 
                            string="Approve" 
                            type="object" 
                            class="btn-success"
                            groups="custom_purchase_process.group_purchase_request_ceos"
                            invisible="state != 'reviewed'"/>

                    <button name="action_reset_to_draft" 
                            string="Reset to Draft" 
                            type="object" 
                            class="btn-warning"
                            groups="custom_purchase_process.group_purchase_request_ceos"
                            invisible="state != 'reviewed'"/>

                    <button name="action_reject" 
                            string="Reject" 
                            type="object" 
                            class="btn-danger"
                            groups="custom_purchase_process.group_purchase_request_ceos"
                            invisible="state != 'reviewed'"/>

                    <button name="action_reset_to_draft_from_states" 
                            string="Reset to Draft" 
                            type="object" 
                            class="btn-warning"
                            groups="custom_purchase_process.group_purchase_request_ceos,custom_purchase_process.group_custom_purchase_request_super_admin"
                            invisible="state not in ['approved', 'rfq', 'supplier_analysis']"/>

                    <button name="action_set_rfq" 
                            string="Create RFQ" 
                            type="object" 
                            class="btn-info"
                            groups="custom_purchase_process.group_custom_purchase_request_purchaser"
                            invisible="state not in ['approved', 'rfq', 'supplier_analysis']"/>

                    <button name="%(action_purchase_quotation_report)d" string="Print Quotation"
                            groups="custom_purchase_process.group_custom_purchase_request_purchaser"
                            type="action" class="btn-primary"
                            invisible="state not in ['approved', 'rfq']"/>

                    <!-- <button name="action_generate_purchase_order" 
                            type="object" 
                            string="Generate Purchase Order"
                            class="btn-primary" 
                            groups="custom_purchase_process.group_custom_purchase_request_purchaser"
                            invisible="state != 'supplier_analysis'"/> -->

                    <button name="action_set_supplier_analysis" 
                            string="Supplier Analysis" 
                            type="object"
                            class="btn-warning" 
                            groups="custom_purchase_process.group_custom_purchase_request_purchaser"
                            invisible="state not in ['rfq', 'supplier_analysis']"/>

                    

                
                </header>

                <sheet>




                
                    <div class="oe_button_box" name="button_box">

                        <button class="oe_stat_button" 
                                name="action_view_quotations" 
                                type="object"
                                icon="fa-external-link">                                            
                                    <div class="o_stat_info">
                                        <span class="o_stat_value">
                                            <field name="quotation_count" widget="statinfo" string=" RFQ(s)"/>
                                        </span>
                                    </div>
                        </button>
                            

                        <button class="oe_stat_button"
                                type="object" 
                                name="action_view_sa"
                                icon="fa-external-link"
                                string="Supplier Analysis">
                                    <div class="o_stat_info">
                                        <span class="o_stat_value">
                                            <field name="supplier_analysis_count" widget="statinfo" string=" SA(s)"/>
                                        </span>
                                    </div>
                        </button>


                        <button class="oe_stat_button" 
                                name="action_view_po" 
                                type="object"
                                icon="fa-external-link">                                            
                                    <div class="o_stat_info">
                                        <span class="o_stat_value">
                                            <field name="purchase_order_count" widget="statinfo" string=" PO(s)"/>
                                        </span>
                                    </div>
                        </button>






                        <!-- <button type="object" name="action_view_po"
                                icon="fa-external-link"
                                string="PO"
                                class="oe_stat_button"/> -->

                    </div>

                    <div class="o_form_sheet_bg">
                        <h1>
                            <field name="name" class="o_inline_display"/>
                        </h1>
                    </div>
                    <group>
                        <group>
                            <field name="material_request_id" invisible="material_request_id == False" readonly="1"/>
                            
                            <field name="requested_by" readonly="1"/>
                            
                            <field name="checked_by_id" invisible="state == 'draft'" readonly="1"/>
                            <field name="reviewed_by_id" invisible="state == 'draft'" readonly="1"/>
                            <field name="approved_by_id" invisible="state == 'draft'" modifiers="{'readonly': true}"
                                   force_save="1" readonly="1"/>
                        </group>
                        <group>
                            <field name="date_requested" readonly="1"/>
                            <field name="quality_evaluation" readonly="state not in ['draft','submitted']"/>
                            <!-- <field name="state" readonly="0"/> -->
                            <field name="company_id" readonly="state not in ['draft','submitted']"/>
                            <field name="user_id" readonly="state not in ['reviewed','approved']" />

                            <field name="reason_for_rejection" readonly="state == 'rejected'"/>
                            <field name="rejection_reason" readonly="1" invisible="not rejection_reason"/>
                            

                        </group>
                    </group>

                    <notebook>
                        <page string="Request Lines">
                            <field name="purchase_request_line_ids" create="0" delete="0" options="{'no_create': True, 'no_create_edit': True, 'no_open': True}">
                                <list editable="bottom" no_create="1" no_open="1">
                                    <field name="state" column_invisible="1"/>
                                    <field name="product_id" string="Product" readonly="1"/>
                                    <field name="description" string="Description" readonly="1"/>
                                    <field name="product_uom_id" string="UOM" readonly="1"/>
                                    <field name="quantity" string="Quantity" readonly="1"/>
                                    <field name="unit_price" string="Unit Price" readonly="1"/>
                                    <field name="subtotal" string="Subtotal" readonly="1" force_save="1"/>
                                    <field name="qa_required" optional="hide" readonly="1"/>
                                </list>
                            </field>
                        </page>
                    </notebook>
                </sheet>
                <chatter/>
            </form>
        </field>
    </record>

    <record id="action_purchase_request" model="ir.actions.act_window">
        <field name="name">Purchase Request</field>
        <field name="res_model">purchase.request</field>
        <field name="view_mode">list,form</field>
    </record>

    <menuitem id="menu_purchase_request_root_module" 
              name="Purchase Request"
              web_icon="custom_purchase_process,static/description/purchase_request.png"
              groups="custom_purchase_process.group_custom_purchase_request_purchaser,custom_purchase_process.group_custom_purchase_request_approvers,custom_purchase_process.group_purchase_request_ceos,custom_purchase_process.group_custom_purchase_request_super_admin" />   
              
    <menuitem id="menu_purchase_request_root_menus" 
              name="Purchase Request"
              parent="menu_purchase_request_root_module"/>           
              
    
    <menuitem id="menu_purchase_request_sub_menus" 
              name="Purchase Request"
              parent="menu_purchase_request_root_menus"
              sequence="1"
              action="action_purchase_request"/>

     <!-- <menuitem id="menu_purchase_request" parent="menu_purchase_management" name="Purchase Requests"
               action="action_purchase_request"
              sequence="1"/> -->

</odoo>