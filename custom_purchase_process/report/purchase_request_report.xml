<?xml version="1.0" encoding="UTF-8"?>
<odoo>

    <!-- QWeb: Purchase Request PDF -->
    <template id="report_purchase_request_document">
        <t t-call="web.html_container">
            <t t-call="web.external_layout">
                <t t-set="doc" t-value="docs[0]"/>
                <div style="font-family: Arial, sans-serif; font-size: 12px; margin: 5px;">
                    
                                         <!-- Simple Header -->
                     <div style="text-align: center; margin-bottom: 10px;">
                         <div style="font-size: 24px; font-weight: bold; margin-bottom: 3px; text-transform: uppercase;"><t t-esc="doc.company_id.name or ''"/></div>
                         <div style="font-size: 18px; font-weight: bold;">PURCHASE REQUEST</div>
                     </div>
                    
                    <!-- Basic Info Table -->
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                                                 <tr>
                             <td style="border: 1px solid #000; padding: 5px; width: 25%;"><strong>Request Reference:</strong></td>
                             <td style="border: 1px solid #000; padding: 5px; width: 25%;"><t t-esc="doc.name"/></td>
                             <td style="border: 1px solid #000; padding: 5px; width: 25%;"><strong>Date Requested:</strong></td>
                             <td style="border: 1px solid #000; padding: 5px; width: 25%;"><t t-esc="doc.date_requested or ''"/></td>
                         </tr>
                         <tr>
                             <td style="border: 1px solid #000; padding: 5px; width: 25%;"><strong>Requested By:</strong></td>
                             <td style="border: 1px solid #000; padding: 5px; width: 25%;"><t t-esc="doc.requested_by.name or ''"/></td>
                             <td style="border: 1px solid #000; padding: 5px; width: 25%;"><strong>Department:</strong></td>
                             <td style="border: 1px solid #000; padding: 5px; width: 25%;"><t t-esc="doc.request_department_id.name or ''"/></td>
                         </tr>
                         <tr>
                             <td style="border: 1px solid #000; padding: 5px; width: 25%;"><strong>Procurement Officer:</strong></td>
                             <td style="border: 1px solid #000; padding: 5px; width: 25%;"><t t-esc="doc.user_id.name or ''"/></td>
                             <td style="border: 1px solid #000; padding: 5px; width: 25%;"></td>
                             <td style="border: 1px solid #000; padding: 5px; width: 25%;"></td>
                         </tr>
                    </table>
                    
                    <!-- Main Items Table - Excel Style -->
                    <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
                        <!-- Header Row -->
                        <tr style="background-color: #f0f0f0;">
                            <th style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold; width: 8%; font-size: 13px;">No.</th>
                            <th style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold; width: 35%; font-size: 13px;">Product Name</th>
                            <th style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold; width: 25%; font-size: 13px;">Description</th>
                            <th style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold; width: 12%; font-size: 13px;">UOM</th>
                            <th style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold; width: 10%; font-size: 13px;">Quantity</th>
                            <th style="border: 1px solid #000; padding: 8px; text-align: center; font-weight: bold; width: 10%; font-size: 13px;">Est. Price</th>
                        </tr>
                        
                        <!-- Data Rows -->
                        <t t-foreach="doc.purchase_request_line_ids" t-as="line">
                            <tr>
                                <td style="border: 1px solid #000; padding: 5px; text-align: center; font-size: 12px;"><t t-esc="line_index + 1"/></td>
                                <td style="border: 1px solid #000; padding: 5px; font-size: 12px;"><t t-esc="line.product_id.display_name or ''"/></td>
                                <td style="border: 1px solid #000; padding: 5px; font-size: 12px;"><t t-esc="line.description or line.product_id.name or ''"/></td>
                                <td style="border: 1px solid #000; padding: 5px; text-align: center; font-size: 12px;"><t t-esc="line.product_uom_id.name or ''"/></td>
                                <td style="border: 1px solid #000; padding: 5px; text-align: center; font-size: 12px;"><t t-esc="line.quantity or 0"/></td>
                                <td style="border: 1px solid #000; padding: 5px; text-align: center; font-size: 12px;"><t t-esc="line.unit_price or 0"/></td>
                            </tr>
                        </t>
                    </table>
                    
                    <!-- Authorization Section -->
                    <table style="width: 100%; border-collapse: collapse;">
                        <tr>
                                                         <td style="border: 1px solid #000; padding: 5px; width: 33%; text-align: center;">
                                 <strong>Checked By:</strong><br/>
                                 <strong>Name:</strong> <t t-esc="doc.checked_by_id.name or ''"/><br/>
                                 
                             </td>
                             
                             <td style="border: 1px solid #000; padding: 5px; width: 33%; text-align: center;">
                                 <strong>Reviewed By:</strong><br/>
                                 <strong>Name:</strong> <t t-esc="doc.reviewed_by_id.name or ''"/><br/>
                                 
                             </td>
                             
                             <td style="border: 1px solid #000; padding: 5px; width: 34%; text-align: center;">
                                 <strong>Approved By:</strong><br/>
                                 <strong>Name:</strong> <t t-esc="doc.approved_by_id.name or ''"/><br/>
                                 
                             </td>
                        </tr>
                    </table>
                    
                </div>
            </t>
        </t>
    </template>

    <!-- Report Action -->
    <record id="action_report_purchase_request" model="ir.actions.report">
        <field name="name">Purchase Request</field>
        <field name="model">purchase.request</field>
        <field name="report_type">qweb-pdf</field>
        <field name="report_name">custom_purchase_process.report_purchase_request_document</field>
        <field name="report_file">custom_purchase_process.report_purchase_request_document</field>
        <field name="print_report_name">"Purchase Request - %s" % (object.name)</field>
        <field name="binding_model_id" ref="model_purchase_request"/>
        <field name="binding_type">report</field>
        <field name="binding_view_types">form</field>
    </record>

</odoo>
